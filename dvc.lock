schema: '2.0'
stages:
  install:
    cmd:
    - python3 -m venv venv
    - . venv/bin/activate && pip install -U pip wheel setuptools && pip install -r
      requirements.txt
    - cp requirements.txt venv-installed
    deps:
    - path: requirements.txt
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
  loadvoc:
    cmd: venv/bin/annif load-vocab --force kauno corpora/kauno-skos-reduced.ttl
    deps:
    - path: corpora/kauno-skos-reduced.ttl
      md5: 52f7aeb7e056cbeb3fc87fb2389547e9
      size: 17383751
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: data/vocabs/kauno
      md5: 43f49eabb66648de35d01d57d196e196.dir
      size: 33952771
      nfiles: 3
  train-mllm:
    cmd: venv/bin/annif train kauno-mllm-fi -j 8 -d 2000 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      md5: 6200fab3e9179186787cd49dbcaa587a
      size: 39921230
    - path: data/vocabs/kauno
      md5: 43f49eabb66648de35d01d57d196e196.dir
      size: 33952771
      nfiles: 3
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: data/projects/kauno-mllm-fi
      md5: d84bdf9dd883429b9b82b9b95abb46c1.dir
      size: 2160115
      nfiles: 2
  train-omikuji@parabel:
    cmd: venv/bin/annif train kauno-parabel-fi -j 8 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      md5: 6200fab3e9179186787cd49dbcaa587a
      size: 39921230
    - path: data/vocabs/kauno
      md5: 43f49eabb66648de35d01d57d196e196.dir
      size: 33952771
      nfiles: 3
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: data/projects/kauno-parabel-fi
      md5: ba358be8ebda5347eba4825fcebcf43a.dir
      size: 327572347
      nfiles: 6
  train-omikuji@bonsai:
    cmd: venv/bin/annif train kauno-bonsai-fi -j 8 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      md5: 6200fab3e9179186787cd49dbcaa587a
      size: 39921230
    - path: data/vocabs/kauno
      md5: 43f49eabb66648de35d01d57d196e196.dir
      size: 33952771
      nfiles: 3
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: data/projects/kauno-bonsai-fi
      md5: 93b109deb653d12ea6137f3f67742934.dir
      size: 428545588
      nfiles: 6
  eval@bonsai:
    cmd:
    - venv/bin/annif eval kauno-bonsai-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-bonsai-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-bonsai-fi
      md5: 93b109deb653d12ea6137f3f67742934.dir
      size: 428545588
      nfiles: 6
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: reports/kauno-bonsai-fi.json
      md5: 0cb706d29e2c34c41292f422c0d71dd6
      size: 93
  eval@mllm:
    cmd:
    - venv/bin/annif eval kauno-mllm-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-mllm-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-mllm-fi
      md5: d84bdf9dd883429b9b82b9b95abb46c1.dir
      size: 2160115
      nfiles: 2
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: reports/kauno-mllm-fi.json
      md5: 19400d41ad5705049ac215faca7cfead
      size: 95
  eval@parabel:
    cmd:
    - venv/bin/annif eval kauno-parabel-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-parabel-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-parabel-fi
      md5: ba358be8ebda5347eba4825fcebcf43a.dir
      size: 327572347
      nfiles: 6
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: reports/kauno-parabel-fi.json
      md5: 56697a462498d0fc1b0dbe0f39dce592
      size: 94
  eval@ensemble:
    cmd:
    - venv/bin/annif eval kauno-ensemble-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-ensemble-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-ensemble-fi
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: reports/kauno-ensemble-fi.json
      md5: 7e01af13fd914a0db8e4421fb575423b
      size: 93
