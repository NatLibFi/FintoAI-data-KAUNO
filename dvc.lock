schema: '2.0'
stages:
  install:
    cmd:
    - python3 -m venv venv
    - . venv/bin/activate && pip install -U pip wheel setuptools && pip install -r
      requirements.txt
    - cp requirements.txt venv-installed
    deps:
    - path: requirements.txt
      md5: 79f04b91351d295dc7bdd75aab5b4170
      size: 42
    outs:
    - path: venv-installed
      md5: 79f04b91351d295dc7bdd75aab5b4170
      size: 42
  loadvoc:
    cmd: venv/bin/annif loadvoc --force kauno-mllm-fi corpora/kauno-skos.ttl
    deps:
    - path: corpora/kauno-skos.ttl
      md5: 09d7ce169c0b1d1115aefdff267b8e6b
      size: 21347813
    - path: venv-installed
      md5: 79f04b91351d295dc7bdd75aab5b4170
      size: 42
    outs:
    - path: data/vocabs/kauno
      md5: a11b4c697dec1f4179b121949e34007f.dir
      size: 40774070
      nfiles: 3
  train-mllm:
    cmd: venv/bin/annif train kauno-mllm-fi -j 8 -d 2000 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      md5: 6200fab3e9179186787cd49dbcaa587a
      size: 39921230
    - path: data/vocabs/kauno
      md5: a11b4c697dec1f4179b121949e34007f.dir
      size: 40774070
      nfiles: 3
    - path: venv-installed
      md5: 79f04b91351d295dc7bdd75aab5b4170
      size: 42
    outs:
    - path: data/projects/kauno-mllm-fi
      md5: 1ef7d6f9da540e3956706d42cfc274b9.dir
      size: 2666668
      nfiles: 2
  train-omikuji@parabel:
    cmd: venv/bin/annif train kauno-parabel-fi -j 8 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      md5: 6200fab3e9179186787cd49dbcaa587a
      size: 39921230
    - path: data/vocabs/kauno
      md5: a11b4c697dec1f4179b121949e34007f.dir
      size: 40774070
      nfiles: 3
    - path: venv-installed
      md5: 79f04b91351d295dc7bdd75aab5b4170
      size: 42
    outs:
    - path: data/projects/kauno-parabel-fi
      md5: b617ecfc8733c13bd5a831951cf60d06.dir
      size: 327132981
      nfiles: 6
  train-omikuji@bonsai:
    cmd: venv/bin/annif train kauno-bonsai-fi -j 8 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      md5: 6200fab3e9179186787cd49dbcaa587a
      size: 39921230
    - path: data/vocabs/kauno
      md5: a11b4c697dec1f4179b121949e34007f.dir
      size: 40774070
      nfiles: 3
    - path: venv-installed
      md5: 79f04b91351d295dc7bdd75aab5b4170
      size: 42
    outs:
    - path: data/projects/kauno-bonsai-fi
      md5: ef6a51cfa950d03acc1621089161c65b.dir
      size: 430377127
      nfiles: 6
  eval@bonsai:
    cmd:
    - venv/bin/annif eval kauno-bonsai-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-bonsai-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-bonsai-fi
      md5: ef6a51cfa950d03acc1621089161c65b.dir
      size: 430377127
      nfiles: 6
    - path: venv-installed
      md5: 79f04b91351d295dc7bdd75aab5b4170
      size: 42
    outs:
    - path: reports/kauno-bonsai-fi.json
      md5: eb24fb34a9ef2597fa30592220448afc
      size: 94
  eval@mllm:
    cmd:
    - venv/bin/annif eval kauno-mllm-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-mllm-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-mllm-fi
      md5: 1ef7d6f9da540e3956706d42cfc274b9.dir
      size: 2666668
      nfiles: 2
    - path: venv-installed
      md5: 79f04b91351d295dc7bdd75aab5b4170
      size: 42
    outs:
    - path: reports/kauno-mllm-fi.json
      md5: 2cc7cbfb1fe27632ea868531bb93242a
      size: 93
  eval@parabel:
    cmd:
    - venv/bin/annif eval kauno-parabel-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-parabel-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-parabel-fi
      md5: b617ecfc8733c13bd5a831951cf60d06.dir
      size: 327132981
      nfiles: 6
    - path: venv-installed
      md5: 79f04b91351d295dc7bdd75aab5b4170
      size: 42
    outs:
    - path: reports/kauno-parabel-fi.json
      md5: 5ad309e431cd73937cd5a6c69ba8f64b
      size: 95
  eval@ensemble:
    cmd:
    - venv/bin/annif eval kauno-ensemble-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-ensemble-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-ensemble-fi
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
    - path: venv-installed
      md5: 79f04b91351d295dc7bdd75aab5b4170
      size: 42
    outs:
    - path: reports/kauno-ensemble-fi.json
      md5: 937144884444ec3c0a177b8798b287a0
      size: 95
