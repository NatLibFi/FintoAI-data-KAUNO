schema: '2.0'
stages:
  install:
    cmd:
    - python3 -m venv venv
    - . venv/bin/activate && pip install -U pip wheel setuptools && pip install -r
      requirements.txt
    - cp requirements.txt venv-installed
    deps:
    - path: requirements.txt
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
  loadvoc:
    cmd: venv/bin/annif load-vocab --force kauno corpora/kauno-skos-reduced.ttl
    deps:
    - path: corpora/kauno-skos-reduced.ttl
      hash: md5
      md5: 6ca997fbaed020b9bfa867c991b19739
      size: 17501880
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: data/vocabs/kauno
      hash: md5
      md5: 8d23b787082ad96201ffb484ec6fb681.dir
      size: 34076325
      nfiles: 3
  train-mllm:
    cmd: venv/bin/annif train kauno-mllm-fi -j 8 -d 2000 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      hash: md5
      md5: 77c01592d2c7c34f04bbee75b6584ec8
      size: 58959362
    - path: data/vocabs/kauno
      hash: md5
      md5: 8d23b787082ad96201ffb484ec6fb681.dir
      size: 34076325
      nfiles: 3
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: data/projects/kauno-mllm-fi
      hash: md5
      md5: 23c57a221af59d0d2541a7df9e37ad7c.dir
      size: 2261733
      nfiles: 2
  train-omikuji@parabel:
    cmd: venv/bin/annif train kauno-parabel-fi -j 8 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      md5: 6200fab3e9179186787cd49dbcaa587a
      size: 39921230
    - path: data/vocabs/kauno
      md5: 43f49eabb66648de35d01d57d196e196.dir
      size: 33952771
      nfiles: 3
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: data/projects/kauno-parabel-fi
      md5: ba358be8ebda5347eba4825fcebcf43a.dir
      size: 327572347
      nfiles: 6
  train-omikuji@bonsai:
    cmd: venv/bin/annif train kauno-bonsai-fi -j 8 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      md5: 6200fab3e9179186787cd49dbcaa587a
      size: 39921230
    - path: data/vocabs/kauno
      md5: 43f49eabb66648de35d01d57d196e196.dir
      size: 33952771
      nfiles: 3
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: data/projects/kauno-bonsai-fi
      md5: 93b109deb653d12ea6137f3f67742934.dir
      size: 428545588
      nfiles: 6
  eval@bonsai:
    cmd:
    - venv/bin/annif eval kauno-bonsai-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-bonsai-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-bonsai-fi
      md5: 93b109deb653d12ea6137f3f67742934.dir
      size: 428545588
      nfiles: 6
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: reports/kauno-bonsai-fi.json
      md5: 0cb706d29e2c34c41292f422c0d71dd6
      size: 93
  eval@mllm:
    cmd:
    - venv/bin/annif eval kauno-mllm-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-mllm-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      hash: md5
      md5: 2a491f3d2b35df602a3730db99f7605c
      size: 1502390
    - path: data/projects/kauno-mllm-fi
      hash: md5
      md5: 23c57a221af59d0d2541a7df9e37ad7c.dir
      size: 2261733
      nfiles: 2
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: reports/kauno-mllm-fi.json
      hash: md5
      md5: 9b94207439de0dee3c8efb58eaf23bdb
      size: 95
  eval@parabel:
    cmd:
    - venv/bin/annif eval kauno-parabel-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-parabel-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-parabel-fi
      md5: ba358be8ebda5347eba4825fcebcf43a.dir
      size: 327572347
      nfiles: 6
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: reports/kauno-parabel-fi.json
      md5: 56697a462498d0fc1b0dbe0f39dce592
      size: 94
  eval@ensemble:
    cmd:
    - venv/bin/annif eval kauno-ensemble-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-ensemble-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      hash: md5
      md5: 2a491f3d2b35df602a3730db99f7605c
      size: 1502390
    - path: data/projects/kauno-ensemble-fi
      hash: md5
      md5: 3c5b9e385b3d59c658f823a92dfd34f6.dir
      size: 1223621179
      nfiles: 3
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: reports/kauno-ensemble-fi.json
      hash: md5
      md5: bc2d8f32c841e8941bba9fcd88a92896
      size: 94
  train-omikuji-ks@parabel:
    cmd: venv/bin/annif train kauno-ks-parabel-fi -j 8 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      md5: 6200fab3e9179186787cd49dbcaa587a
      size: 39921230
    - path: data/vocabs/kauno
      md5: 43f49eabb66648de35d01d57d196e196.dir
      size: 33952771
      nfiles: 3
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: data/projects/kauno-ks-parabel-fi
      md5: d24263f3ad1b5c3373ba6b1b86a4a222.dir
      size: 327667525
      nfiles: 6
  train-omikuji-finna@bonsai:
    cmd: venv/bin/annif train kauno-finna-bonsai-fi -j 8 corpora/finna/kauno-finna-fin.tsv.gz
    deps:
    - path: corpora/finna/kauno-finna-fin.tsv.gz
      md5: ae570f73cbc72bd952efebd67575cda4
      size: 63666506
    - path: data/vocabs/kauno
      md5: 43f49eabb66648de35d01d57d196e196.dir
      size: 33952771
      nfiles: 3
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: data/projects/kauno-finna-bonsai-fi
      md5: 16418f34c02a34155b9db383138a8d87.dir
      size: 546792457
      nfiles: 6
  train-omikuji-finna@parabel:
    cmd: venv/bin/annif train kauno-finna-parabel-fi -j 8 corpora/finna/kauno-finna-fin.tsv.gz
    deps:
    - path: corpora/finna/kauno-finna-fin.tsv.gz
      md5: ae570f73cbc72bd952efebd67575cda4
      size: 63666506
    - path: data/vocabs/kauno
      md5: 43f49eabb66648de35d01d57d196e196.dir
      size: 33952771
      nfiles: 3
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: data/projects/kauno-finna-parabel-fi
      md5: f952af490b34403547b9dd3204d63e15.dir
      size: 379427399
      nfiles: 6
  eval@finna-bonsai:
    cmd:
    - venv/bin/annif eval kauno-finna-bonsai-fi -j 8 -m F1@5 -m NDCG --metrics-file
      reports/kauno-finna-bonsai-fi.json corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      hash: md5
      md5: 2a491f3d2b35df602a3730db99f7605c
      size: 1502390
    - path: data/projects/kauno-finna-bonsai-fi
      hash: md5
      md5: eb1d5d6d196c0237832da37d53680b78.dir
      size: 542003428
      nfiles: 6
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: reports/kauno-finna-bonsai-fi.json
      hash: md5
      md5: fe5bc33b1f952c4d330ee1a12613fd9c
      size: 94
  eval@finna-parabel:
    cmd:
    - venv/bin/annif eval kauno-finna-parabel-fi -j 8 -m F1@5 -m NDCG --metrics-file
      reports/kauno-finna-parabel-fi.json corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-finna-parabel-fi
      md5: f952af490b34403547b9dd3204d63e15.dir
      size: 379427399
      nfiles: 6
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: reports/kauno-finna-parabel-fi.json
      md5: e037704630021469933d06952c18d27e
      size: 95
  eval@ks-parabel:
    cmd:
    - venv/bin/annif eval kauno-ks-parabel-fi -j 8 -m F1@5 -m NDCG --metrics-file
      reports/kauno-ks-parabel-fi.json corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      md5: 48611b60c8006116b9c8686456dcfbf6
      size: 1535757
    - path: data/projects/kauno-ks-parabel-fi
      md5: d24263f3ad1b5c3373ba6b1b86a4a222.dir
      size: 327667525
      nfiles: 6
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: reports/kauno-ks-parabel-fi.json
      md5: 5615be39b149e641186f32916d80b0a5
      size: 94
  train-omikuji-ks@bonsai:
    cmd: venv/bin/annif train kauno-ks-bonsai-fi -j 8 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      md5: 6200fab3e9179186787cd49dbcaa587a
      size: 39921230
    - path: data/vocabs/kauno
      md5: 43f49eabb66648de35d01d57d196e196.dir
      size: 33952771
      nfiles: 3
    - path: venv-installed
      md5: b1b83339d2df42e93f3df0e83b1e85ab
      size: 42
    outs:
    - path: data/projects/kauno-ks-bonsai-fi
      md5: 3130bd53059af8c55630d94116657d4f.dir
      size: 426174615
      nfiles: 6
  eval@ks-bonsai:
    cmd:
    - venv/bin/annif eval kauno-ks-bonsai-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-ks-bonsai-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      hash: md5
      md5: 2a491f3d2b35df602a3730db99f7605c
      size: 1502390
    - path: data/projects/kauno-ks-bonsai-fi
      hash: md5
      md5: 7f3dae80e066dae4428a86bba7eea413.dir
      size: 745367632
      nfiles: 6
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: reports/kauno-ks-bonsai-fi.json
      hash: md5
      md5: 9c16b8188723d2a92c8a4117e841fa83
      size: 94
  train-omikuji-ks:
    cmd: venv/bin/annif train kauno-ks-bonsai-fi -j 8 corpora/kirjasampo/kirjasampo-kauno-train.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-train.tsv
      hash: md5
      md5: 77c01592d2c7c34f04bbee75b6584ec8
      size: 58959362
    - path: data/vocabs/kauno
      hash: md5
      md5: 8d23b787082ad96201ffb484ec6fb681.dir
      size: 34076325
      nfiles: 3
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: data/projects/kauno-ks-bonsai-fi
      hash: md5
      md5: 7f3dae80e066dae4428a86bba7eea413.dir
      size: 745367632
      nfiles: 6
  train-omikuji-finna:
    cmd: venv/bin/annif train kauno-finna-bonsai-fi -j 8 corpora/finna/kauno-finna-fin.tsv.gz
    deps:
    - path: corpora/finna/kauno-finna-fin.tsv.gz
      md5: ae570f73cbc72bd952efebd67575cda4
      size: 63666506
    - path: data/vocabs/kauno
      hash: md5
      md5: 8d23b787082ad96201ffb484ec6fb681.dir
      size: 34076325
      nfiles: 3
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: data/projects/kauno-finna-bonsai-fi
      hash: md5
      md5: eb1d5d6d196c0237832da37d53680b78.dir
      size: 542003428
      nfiles: 6
  train-ensemble:
    cmd: venv/bin/annif train -j 8 kauno-ensemble-fi corpora/kirjasampo/kirjasampo-kauno-validate.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-validate.tsv
      hash: md5
      md5: 6dbd774820c16dbd440da71151e36079
      size: 2455221
    - path: data/projects/kauno-finna-bonsai-fi
      hash: md5
      md5: eb1d5d6d196c0237832da37d53680b78.dir
      size: 542003428
      nfiles: 6
    - path: data/projects/kauno-ks-bonsai-fi
      hash: md5
      md5: 7f3dae80e066dae4428a86bba7eea413.dir
      size: 745367632
      nfiles: 6
    - path: data/projects/kauno-mllm-fi
      hash: md5
      md5: 23c57a221af59d0d2541a7df9e37ad7c.dir
      size: 2261733
      nfiles: 2
    - path: data/vocabs/kauno
      hash: md5
      md5: 8d23b787082ad96201ffb484ec6fb681.dir
      size: 34076325
      nfiles: 3
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: data/projects/kauno-ensemble-fi
      hash: md5
      md5: 3c5b9e385b3d59c658f823a92dfd34f6.dir
      size: 1223621179
      nfiles: 3
  train-nn-ensemble:
    cmd: venv/bin/annif train -j 8 kauno-fi corpora/kirjasampo/kirjasampo-kauno-validate.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-validate.tsv
      hash: md5
      md5: 6dbd774820c16dbd440da71151e36079
      size: 2455221
    - path: data/projects/kauno-finna-bonsai-fi
      hash: md5
      md5: eb1d5d6d196c0237832da37d53680b78.dir
      size: 542003428
      nfiles: 6
    - path: data/projects/kauno-ks-bonsai-fi
      hash: md5
      md5: 7f3dae80e066dae4428a86bba7eea413.dir
      size: 745367632
      nfiles: 6
    - path: data/projects/kauno-mllm-fi
      hash: md5
      md5: 23c57a221af59d0d2541a7df9e37ad7c.dir
      size: 2261733
      nfiles: 2
    - path: data/vocabs/kauno
      hash: md5
      md5: 8d23b787082ad96201ffb484ec6fb681.dir
      size: 34076325
      nfiles: 3
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: data/projects/kauno-fi
      hash: md5
      md5: ce989b5df6c6771b0e60aefb8a7d4ec9.dir
      size: 1223621179
      nfiles: 3
  eval@mllm-fi:
    cmd:
    - venv/bin/annif eval kauno-mllm-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-mllm-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      hash: md5
      md5: 2a491f3d2b35df602a3730db99f7605c
      size: 1502390
    - path: data/projects/kauno-mllm-fi
      hash: md5
      md5: 23c57a221af59d0d2541a7df9e37ad7c.dir
      size: 2261733
      nfiles: 2
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: reports/kauno-mllm-fi.json
      hash: md5
      md5: 9b94207439de0dee3c8efb58eaf23bdb
      size: 95
  eval@ks-bonsai-fi:
    cmd:
    - venv/bin/annif eval kauno-ks-bonsai-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-ks-bonsai-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      hash: md5
      md5: 2a491f3d2b35df602a3730db99f7605c
      size: 1502390
    - path: data/projects/kauno-ks-bonsai-fi
      hash: md5
      md5: 7f3dae80e066dae4428a86bba7eea413.dir
      size: 745367632
      nfiles: 6
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: reports/kauno-ks-bonsai-fi.json
      hash: md5
      md5: 9c16b8188723d2a92c8a4117e841fa83
      size: 94
  eval@finna-bonsai-fi:
    cmd:
    - venv/bin/annif eval kauno-finna-bonsai-fi -j 8 -m F1@5 -m NDCG --metrics-file
      reports/kauno-finna-bonsai-fi.json corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      hash: md5
      md5: 2a491f3d2b35df602a3730db99f7605c
      size: 1502390
    - path: data/projects/kauno-finna-bonsai-fi
      hash: md5
      md5: eb1d5d6d196c0237832da37d53680b78.dir
      size: 542003428
      nfiles: 6
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: reports/kauno-finna-bonsai-fi.json
      hash: md5
      md5: fe5bc33b1f952c4d330ee1a12613fd9c
      size: 94
  eval@fi:
    cmd:
    - venv/bin/annif eval kauno-fi -j 8 -m F1@5 -m NDCG --metrics-file reports/kauno-fi.json
      corpora/kirjasampo/kirjasampo-kauno-test.tsv
    deps:
    - path: corpora/kirjasampo/kirjasampo-kauno-test.tsv
      hash: md5
      md5: 2a491f3d2b35df602a3730db99f7605c
      size: 1502390
    - path: data/projects/kauno-fi
      hash: md5
      md5: ce989b5df6c6771b0e60aefb8a7d4ec9.dir
      size: 1223621179
      nfiles: 3
    - path: venv-installed
      hash: md5
      md5: f85f21b68735b126c2241fbff83fd0ef
      size: 41
    outs:
    - path: reports/kauno-fi.json
      hash: md5
      md5: 500d93c3d47823dbef945b2efa8899e4
      size: 93
